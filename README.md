# Robocup Soccer Simulator
2D-симулятор игры в футбол автономных роботов (изначально для RCJ Soccer Lightweight, возможна модификация под другие категории). Цель проекта - сделать разработку игровой логики независимой от аппаратной части, а также упростить отладку. Разработан командой White Wings в 2024 году.

## Начало использования
Установите Unity, создайте пустой проект и вставьте вместо папки Assets предоставленную в репозитории.
Откройте сцену `Assets/Scenes/SampleScene.unity`.

## Сцена по умолчанию
На сцене содержится изображение поля, нарисованное программно согласно регламенту 2023 года (точность 1 пиксель = 1 мм, 1 юнит сцены соответствует 100 пикселям = 10 см). Также есть 2 робота (диаметр около 20 см, 4 омниколеса, 16 датчиков линии, дриблер, кикер и т.д.) и ИК-мяч.

## Кастомизация роботов
Чтобы подобрать размеры вашего робота, создайте изображение соответствующего масштаба, вставьте его в поле `Sprite` компонента `SpriteRenderer` и обновите компонент `Polygon Collider 2D` (при надобности). Массу робота (в кг) укажите в поле Mass компонента `Rigidbody2D`.

Скорость мотора (дочерние объекты `wheelN`) контролируется полями `SpeedKP` и `SpeedKD` (PD-регулятор). Можно менять набор устройств у роботов, настраивать в них погрешности для максимального приближения к реальности, у некоторых датчиков - частоту обновления, и т.д.

Меняя поля `Green value` и `White value` у сенсоров линий, настраивается разница между белым и зелёным цветами (диапазон яркости задуман приблизительно как 0-4095).

## Компоненты.
Уже реализованы некоторые компоненты для робота, эмулирующие устройства, например:
* `RobotDriveModule` - драйвер моторов
* `RobotMPUDevice` - гироскоп
* `RobotLineMUX` - опрашивает датчики линий и содержит простую функцию для определения её направления
* `RobotLocator` - определяет параметры сигнала ИК-мяча (угол и силу)
* `RobotTrackingCam` - камера без зеркала
* `RobotOmniCamera` - камера с зеркалом (обзор 360 градусов)
* `RobotKickerDriver` - драйвер кикера
* `RobotDribblerDriver` - драйвер дриблера
* `IRSensor` - одиночный датчик ИК-излучения

Компоненты для других объектов:
* `Motor` - для мотора
* `LineSensor` - для датчиков линий (расставлены по кругу, меняют цвет при детектировании линии)
* `DribblerWheel` - ролик дриблера, контролируется скорость вращения, эффективность передачи, сила вталкивания/выталкивания и т.д.
* `RotatedBall` - самостоятельно реализованная физическая модель мяча, учитывающая вращение по 2 осям и трение. Самая трудная в реализации часть проекта, точность модели удовлетворительная, но для сложных действий, например, закрута, показывает реальные явления только качественно. Для наглядности мяч представлен как вращающийся 3D-объект.

Общее:
* `DraggableObject` - добавьте на все объекты на сцене, которые вы хотите перемещать мышью во время работы программы. Поле useRigidbody позволяет тянуть объект с инерцией.
* `BrightObject` - объект, который должен быть виден на камере. Укажите цвет, которым он должен обладать при детектировании.

Пример ПО робота содержится в RobotSoftware, где уже написана простая логика для демонстрации работы с некоторыми устройствами.

## Симуляция игры
Вы можете запустить игру, нажав комбинацию клавиш `R+0` или кнопку `Restart`. Если разводит команда жёлтых, нажмите `R+1`, синих - `R+2`.

Чтобы отправить робота в аут:
* жёлтый нападающий - `O+1` (O - латинская буква)
* жёлтый защитник - `O+2`
* синий нападающий - `O+3`
* синий защитник - `O+4`

Этот функционал реализован в скрипте `GameManager`, в полях которого можно заменить роботов, убрать их, сместить их стартовые позиции и т.д.

Скрипт `CameraMove` отвечает за изменение масштаба камеры прокруткой мыши и слежение за объектом `Target` на сцене (его можно заменить на робота, мяч или перемещать в окне инспектора).
